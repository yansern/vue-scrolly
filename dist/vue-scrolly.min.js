!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Scrolly={})}(this,function(e){"use strict";function t(){if(!g){g=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),n=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(v=/\b(iPhone|iP[ao]d)/.exec(e),m=/\b(iP[ao]d)/.exec(e),h=/Android/i.exec(e),y=/FBAN\/\w+;/i.exec(e),b=/Mobile/i.exec(e),p=!!/Win64/.exec(e),t){(r=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN)&&document&&document.documentMode&&(r=document.documentMode);var o=/(?:Trident\/(\d+.\d+))/.exec(e);c=o?parseFloat(o[1])+4:r,i=t[2]?parseFloat(t[2]):NaN,a=t[3]?parseFloat(t[3]):NaN,(l=t[4]?parseFloat(t[4]):NaN)?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),s=t&&t[1]?parseFloat(t[1]):NaN):s=NaN}else r=i=a=s=l=NaN;if(n){if(n[1]){var w=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);d=!w||parseFloat(w[1].replace("_","."))}else d=!1;u=!!n[2],f=!!n[3]}else d=u=f=!1}}function n(e){var t=0,n=0,o=0,r=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),o=t*T,r=n*T,"deltaY"in e&&(r=e.deltaY),"deltaX"in e&&(o=e.deltaX),(o||r)&&e.deltaMode&&(1==e.deltaMode?(o*=N,r*=N):(o*=D,r*=D)),o&&!t&&(t=o<1?-1:1),r&&!n&&(n=r<1?-1:1),{spinX:t,spinY:n,pixelX:o,pixelY:r}}function o(e){return 100*e+"%"}var r,i,a,l,s,c,d,u,f,h,p,v,m,y,b,w,g=!1,x={ie:function(){return t()||r},ieCompatibilityMode:function(){return t()||c>r},ie64:function(){return x.ie()&&p},firefox:function(){return t()||i},opera:function(){return t()||a},webkit:function(){return t()||l},safari:function(){return x.webkit()},chrome:function(){return t()||s},windows:function(){return t()||u},osx:function(){return t()||d},linux:function(){return t()||f},iphone:function(){return t()||v},mobile:function(){return t()||v||m||h||b},nativeApp:function(){return t()||y},android:function(){return t()||h},ipad:function(){return t()||m}},S=x,L=!("undefined"==typeof window||!window.document||!window.document.createElement),E={canUseDOM:L,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:L&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:L&&!!window.screen,isInWorker:!L};E.canUseDOM&&(w=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""));var M=function(e,t){if(!E.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,o=n in document;if(!o){var r=document.createElement("div");r.setAttribute(n,"return;"),o="function"==typeof r[n]}return!o&&w&&"wheel"===e&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o},T=10,N=40,D=800;n.getEventType=function(){return S.firefox()?"DOMMouseScroll":M("wheel")?"wheel":"mousewheel"};var W=n,O=!1;try{var P=Object.defineProperty({},"passive",{get:function(){O=!0}});window.addEventListener("test",null,P)}catch(e){}var k="MutationObserver"in window,H="mousemove",X="mouseup",B={name:"scrolly",props:{parentScroll:{type:Boolean,default:!0},passiveScroll:{type:Boolean,default:!1}},data:function(){return{container:null,viewport:null,barX:null,barY:null,onMouseWheelHandler:null,onDomChangeHandler:null,mutationObserver:null,isScrolling:!1}},computed:{classnames:function(){return["scrolly",this.isScrolling?"is-scrolling":""]}},mounted:function(){this.$nextTick(function(){for(var e,t,n,o,r=this.$el,i=r.childNodes,a=0;o=i[a++];){var l=o.className;l&&(l.match("scrolly-viewport")&&(e=o),l.match("axis-x")&&(t=o),l.match("axis-y")&&(n=o))}if(e&&(t||n)){var s=this.onMouseWheel.bind(this),c=!!this.parentScroll&&this.passiveScroll;r.addEventListener("wheel",s,!!O&&{passive:c});var d,u=this.onDomChange.bind(this);k?(d=new MutationObserver(u)).observe(e,{childList:!0,characterData:!0,subtree:!0,attributes:!0}):(e.addEventListener("DOMSubtreeModified",u),e.addEventListener("propertychange",u)),Object.assign(this,{container:r,viewport:e,barX:t,barY:n,onMouseWheelHandler:s,onDomChangeHandler:u,mutationObserver:d})}})},methods:{onMouseEnter:function(){this.refreshScrollLayout()},onMouseDown:function(e){function t(e){e.preventDefault();var t=e.pageX,n=e.pageY;if(m){var l=h.scrollLeft,d=h.scrollWidth,p=h.offsetWidth,v=r.offsetWidth,g=p-v,x=w+(t-i);x<0&&(x=0),x>g&&(x=g),r.style.left=o(x/p),h.scrollLeft=x/g*(d-p);var S=x<0,L=x>g,E=S||L;s.x=u.scrollLayout={barX:u,scrollLeft:l,scrollWidth:d,viewportWidth:p,barWidth:v,barLeft:x,minBarLeft:0,maxBarLeft:g,visible:!0,onLeftEdge:S,onRightEdge:L,onEdge:E,canUnlockParentScroll:!1,canScrollParent:!1}}if(y){var M=h.scrollTop,T=h.scrollHeight,N=h.offsetHeight,D=r.offsetHeight,W=N-D,O=b+(n-a);O<0&&(O=0),O>W&&(O=W),r.style.top=o(O/N),h.scrollTop=O/W*(T-N);var P=O<=0,k=O>=W,H=P||k;s.y=f.scrollLayout={barY:f,scrollTop:M,scrollHeight:T,viewportHeight:N,barHeight:D,barTop:O,minBarTop:0,maxBarTop:W,onTopEdge:P,onBottomEdge:k,onEdge:H,visible:!0,canUnlockParentScroll:!1,canScrollParent:!1,scrolled:!0}}c.$emit("scrollchange",s)}function n(){c.isScrolling=!1,v(X,n),v(H,t)}var r=e.target,i=e.pageX,a=e.pageY,l=r.className;if(l.match("scrolly-bar")){var s={},c=this,d=this,u=d.barX,f=d.barY,h=this.viewport,p=window.addEventListener,v=window.removeEventListener,m=l.match("axis-x"),y=l.match("axis-y"),b=r.offsetTop,w=r.offsetLeft;c.isScrolling=!0,p("mousemove",t),p("mouseup",n)}},onMouseWheel:function(e){var t=W(e),n=t.pixelX,o=t.pixelY,r=this.refreshScrollLayout(n,o),i=r.x,a=r.y;if(!this.passiveScroll){var l=i&&i.canScrollParent,s=a&&a.canScrollParent;(!this.parentScroll||!(l||s))&&e.preventDefault()}},onMouseLeave:function(e){var t=this,n=t.barX,o=t.barY;n&&(n.scrollLayout=null),o&&(o.scrollLayout=null)},onDomChange:function(e,t,n){t||(t=250);var o,r;return function(){var i=n||this,a=+new Date,l=arguments;o&&a<o+t?(clearTimeout(r),r=setTimeout(function(){o=a,e.apply(i,l)},t)):(o=a,e.apply(i,l))}}(function(){this.refreshScrollLayout()},250),refreshScrollLayout:function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var n={},r=this,i=r.viewport,a=r.barX,l=r.barY;if(a){var s=0!==e;i.scrollLeft+=e;var c=i.scrollLeft,d=i.scrollWidth,u=i.offsetWidth,f=a.style;f.visibility="hidden",f.display="block",f.width=o(u/d);var h=a.offsetWidth,p=u-h,v=c/(d-u)*p||0,m=v<0,y=v>p,b=m||y;m&&(v=0),y&&(v=p),f.left=o(v/u);var w=h<u;f.display=w?"block":"none",f.visibility="visible";var g=Math.abs(e)>25,x=a.scrollLayout||{},S=x.onEdge,L=x.canUnlockParentScroll,E=!!(x.canScrollParent||S&&L);n.x=a.scrollLayout={barX:a,scrollLeft:c,scrollWidth:d,viewportWidth:u,barWidth:h,barLeft:v,minBarLeft:0,maxBarLeft:p,visible:w,onLeftEdge:m,onRightEdge:y,onEdge:b,visible:w,canUnlockParentScroll:g,canScrollParent:E,scrolled:s}}if(l){var M=0!==t;i.scrollTop+=t;var T=i.scrollTop,N=i.scrollHeight,D=i.offsetHeight,W=l.style;W.visibility="hidden",W.display="block",W.height=o(D/N);var O=l.offsetHeight,P=D-O,k=T/(N-D)*P||0,H=k<=0,X=k>=P,B=H||X;H&&(k=0),X&&(k=P),W.top=o(k/D);var F=O<D;W.display=F?"block":"none",W.visibility="visible";var Y=Math.abs(t)>25,_=l.scrollLayout||{},C=_.onEdge,U=_.canUnlockParentScroll,A=_.canScrollParent,V=!(!B||!(A||C&&U));n.y=l.scrollLayout={barY:l,scrollTop:T,scrollHeight:N,viewportHeight:D,barHeight:O,barTop:k,minBarTop:0,maxBarTop:P,onTopEdge:H,onBottomEdge:X,onEdge:B,visible:F,canUnlockParentScroll:Y,canScrollParent:V,scrolled:M}}return this.$emit("scrollchange",n),n}},beforeDestroy:function(){var e=this,t=e.container,n=e.viewport,o=e.onMouseWheelHandler,r=e.onDomChangeHandler,i=e.mutationObserver;i&&i.disconnect(),k||(n.removeEventListener("DOMSubtreeModified",r),n.removeEventListener("propertychange",r)),t.removeEventListener("wheel",o)}};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),n='.scrolly { position: relative; } .scrolly .scrolly-bar { opacity: 0; } .scrolly:hover .scrolly-bar, .scrolly.is-scrolling .scrolly-bar { opacity: 1; } .scrolly-viewport { position: absolute; overflow: hidden; width: 100%; height: 100%; z-index: 1; } .scrolly-bar { position: absolute; border: 7px solid transparent; cursor: pointer; z-index: 2; transition: opacity .1s ease; } .scrolly-bar:before { position: absolute; width: 100%; height: 100%; content: " "; background: rgba(0, 0, 0, 0.3); border-radius: 7px; transition: background .2s ease; } .scrolly-bar:hover:before { background: rgba(0, 0, 0, 0.6); } .scrolly-bar.axis-x { left: 0; bottom: 0; width: 100%; height: 21px; min-width: 20%; max-width: 100%; } .scrolly-bar.axis-y { top: 0; right: 0; width: 21px; height: 100%; min-height: 20%; max-height: 100%; } ';t.type="text/css",t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n)),e.appendChild(t)}}();var F=Object.assign(B,{render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.classnames,on:{mouseenter:e.onMouseEnter,mousedown:e.onMouseDown,mouseleave:e.onMouseLeave}},[e._t("default")],2)},staticRenderFns:[]});F.prototype=B.prototype,function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText="":t.appendChild(document.createTextNode("")),e.appendChild(t)}}();var Y={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.classnames},[e._t("default")],2)},staticRenderFns:[],name:"scrolly-viewport",computed:{classnames:function(){return["scrolly-viewport"]}}};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText="":t.appendChild(document.createTextNode("")),e.appendChild(t)}}();var _={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.classnames},[e._t("default")],2)},staticRenderFns:[],name:"scrolly-bar",props:{axis:{type:String,default:"y"}},computed:{classnames:function(){return["scrolly-bar","axis-"+this.axis]}}};"undefined"!=typeof window&&window.Vue&&(window.Vue.component("scrolly",F),window.Vue.component("scrolly-viewport",Y),window.Vue.component("scrolly-bar",_)),e.Scrolly=F,e.ScrollyViewport=Y,e.ScrollyBar=_,Object.defineProperty(e,"__esModule",{value:!0})});
